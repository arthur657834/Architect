wget https://bitbucket.org/tsg-/liberasurecode/downloads/liberasurecode-1.1.0.tar.gz

tar xzvf liberasurecode-1.1.0.tar.gz
cd liberasurecode-1.1.0
./configure
make
make install

#还是yum好用
yum -y install ftp://ftp.muug.mb.ca/mirror/centos/7.2.1511/cloud/x86_64/openstack-liberty/common/liberasurecode-1.0.9-3.el7.x86_64.rpm ftp://ftp.muug.mb.ca/mirror/centos/7.2.1511/cloud/x86_64/openstack-liberty/common/liberasurecode-devel-1.0.9-3.el7.x86_64.rpm

yum -y install python34-setuptools
pip install distribute
pip install --upgrade setuptools

yum install -y curl gcc memcached rsync sqlite xfsprogs git-core \
                 libffi-devel xinetd liberasurecode-devel \
                 python-setuptools \
                 python-coverage python-devel python-nose \
                 pyxattr python-eventlet \
                 python-greenlet python-paste-deploy \
                 python-netifaces python-pip python-dns \
                 python-mock

添加硬盘:
fdisk /dev/sdb
mkfs.xfs /dev/sdb1


echo "/dev/sdb1 /mnt/sdb1 xfs noatime,nodiratime,nobarrier,logbufs=8 0 0" >> /etc/fstab

mkdir /mnt/sdb1		 
mount /mnt/sdb1
mkdir /mnt/sdb1/1 /mnt/sdb1/2 /mnt/sdb1/3 /mnt/sdb1/4
mkdir /srv
for x in {1..4}; do sudo ln -s /mnt/sdb1/$x /srv/$x; done
mkdir -p /srv/1/node/sdb1 /srv/1/node/sdb5 \
              /srv/2/node/sdb2 /srv/2/node/sdb6 \
              /srv/3/node/sdb3 /srv/3/node/sdb7 \
              /srv/4/node/sdb4 /srv/4/node/sdb8 \
              /var/run/swift
chown -R ${USER}:${USER} /var/run/swift

# **Make sure to include the trailing slash after /srv/$x/**
for x in {1..4}; do sudo chown -R ${USER}:${USER} /srv/$x/; done
				 
				 

mkdir -p /var/cache/swift /var/cache/swift2 /var/cache/swift3 /var/cache/swift4
chown <your-user-name>:<your-group-name> /var/cache/swift*
mkdir -p /var/run/swift
chown <your-user-name>:<your-group-name> /var/run/swift

cd $HOME; git clone https://github.com/openstack/python-swiftclient.git
cd $HOME/python-swiftclient; sudo pip install -r requirements.txt; sudo python setup.py develop; cd -


git clone https://github.com/openstack/swift.git
cd $HOME/swift
pip install -r requirements.txt
pip install -r test-requirements.txt
python setup.py develop


vi /etc/xinetd.d/rsync
service rsync
{
        disable = no
        socket_type     = stream
        wait            = no
        user            = root
        server          = /usr/bin/rsync
        server_args     = --daemon
        log_on_failure  += USERID
}

sudo cp $HOME/swift/doc/saio/rsyncd.conf /etc/
sudo sed -i "s/<your-user-name>/${USER}/" /etc/rsyncd.conf

sudo systemctl restart xinetd.service
sudo systemctl enable rsyncd.service
sudo systemctl start rsyncd.service

测试
rsync rsync://pub@localhost/


systemctl enable memcached.service
systemctl start memcached.service

cp $HOME/swift/doc/saio/rsyslog.d/10-swift.conf /etc/rsyslog.d/

vi /etc/rsyslog.conf
+ $PrivDropToGroup adm

mkdir -p /var/log/swift/hourly
mkdir -p /var/log/swift

chown -R root:adm /var/log/swift
chmod -R g+w /var/log/swift
systemctl restart rsyslog.service


rm -rf /etc/swift
cd $HOME/swift/doc; sudo cp -r saio/swift /etc/swift; cd -
chown -R ${USER}:${USER} /etc/swift
find /etc/swift/ -name \*.conf | xargs sudo sed -i "s/<your-user-name>/${USER}/"


mkdir -p $HOME/bin
cd $HOME/swift/doc; cp saio/bin/* $HOME/bin; cd -
chmod +x $HOME/bin/*

echo "export SAIO_BLOCK_DEVICE=/srv/swift-disk" >> $HOME/.bashrc
sed -i "/find \/var\/log\/swift/d" $HOME/bin/resetswift
cp $HOME/swift/test/sample.conf /etc/swift/test.conf


echo "export SWIFT_TEST_CONFIG_FILE=/etc/swift/test.conf" >> $HOME/.bashrc

. $HOME/.bashrc

remakerings

#Verify the unit tests run:
$HOME/swift/.unittests 

startmain

curl -v -H 'X-Storage-User: test:tester' -H 'X-Storage-Pass: testing' http://127.0.0.1:8080/auth/v1.0
curl -v -H 'X-Auth-Token: <token-from-x-auth-token-above>' <url-from-x-storage-url-above>

curl -v -H 'X-Auth-Token: AUTH_tk40e95076adba407c82396ea0309b97e3' http://127.0.0.1:8080/v1/AUTH_test




swift -A http://127.0.0.1:8080/auth/v1.0 -U test:tester -K testing stat

$HOME/swift/.functests


$HOME/swift/.probetests




